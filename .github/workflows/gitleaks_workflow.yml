name: Gitleaks

on:
    push: #all branches
    
    workflow_dispatch:

jobs:
    scan:
        name: gitleaks
        runs-on: ubuntu-latest
        steps:
            - name: Check out code
              uses: actions/checkout@v4

            - name: Run Gitleaks             
              uses: gitleaks/gitleaks-action@v2
              env:
                GITLEAKS_LICENSE: ${{ secrets.GITLEAKS_LICENSE}}
                GITLEAKS_CONFIG: './.gitleaks.toml' #optianal step,  gitleaks/gitleaks-action@v2 has prebuild configuration